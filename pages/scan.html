<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scan Wallets - Dolphin Finder</title>
  <link rel="stylesheet" href="../assets/style-neon.css" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(ellipse at center, #000015, #000);
      font-family: 'Orbitron', sans-serif;
      color: #0ff;
      overflow: hidden;
    }

    .container {
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 2;
      position: relative;
      padding: 20px;
    }

    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }

    .glass-card {
      background: rgba(0, 30, 60, 0.3);
      border: 1px solid rgba(0, 255, 255, 0.2);
      box-shadow: 0 8px 30px rgba(0, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      max-width: 600px;
      width: 100%;
      padding: 30px;
      z-index: 3;
      position: relative;
    }

    .scan-btn {
      margin-top: 20px;
      padding: 14px 36px;
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      color: #000;
      background: linear-gradient(135deg, #0ff, #08f);
      box-shadow: 0 0 12px #0ff;
      transition: all 0.3s ease;
    }

    .scan-btn:hover {
      background: linear-gradient(135deg, #09f, #0ff);
      box-shadow: 0 0 25px #0ff;
      transform: scale(1.05);
    }

    /* ÿ±ÿßÿØÿßÿ± ÿ≥Ÿá‚Äåÿ®ÿπÿØ€å */
    .radar {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 32px auto 16px auto;
      display: none;
      border-radius: 50%;
      background: radial-gradient(circle at 65% 35%, #0ff2 0%, #0000 80%),
                  radial-gradient(circle at 35% 65%, #099 5%, #0000 60%),
                  radial-gradient(circle, rgba(0,255,255,0.08) 0%, transparent 70%);
      box-shadow: 0 0 80px #0ff6, 0 0 60px 10px #0ff3 inset, 0 0 24px #06f8 inset;
      overflow: hidden;
      z-index: 8;
      transition: filter .2s;
    }
    .radar::before, .radar::after {
      content: "";
      position: absolute;
      width: 100%; height: 100%; left: 0; top: 0;
      pointer-events: none;
    }
    .radar::before {
      border: 3px solid rgba(0, 255, 255, 0.19);
      border-radius: 50%;
      animation: pulse 2s infinite ease-in-out;
      z-index: 10;
    }
    .radar::after {
      background: conic-gradient(from 0deg, #0ff8 0deg, #0000 60deg, #0ff3 130deg, #0000 360deg);
      filter: blur(2px);
      animation: rotate 1.6s linear infinite;
      z-index: 6;
    }

    /* Neon Loader (Ÿàÿ≥ÿ∑ ÿ±ÿßÿØÿßÿ±) */
    .dolphin-loader {
      position: absolute;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%);
      width: 92px; height: 92px;
      border-radius: 50%;
      border: 8px solid rgba(0,255,255,0.18);
      border-top: 8px solid #0ff;
      border-right: 8px solid #39f;
      border-bottom: 8px solid #0cf;
      border-left: 8px solid #007;
      box-shadow: 0 0 32px #0ff9, 0 0 8px #fff1 inset;
      background: rgba(0,0,0,0.0);
      z-index: 22;
      animation: loader-spin 1.1s cubic-bezier(.68,-0.55,.27,1.55) infinite;
      transition: filter .2s, opacity .2s;
      will-change: transform, filter, opacity;
    }

    /* ⁄©ŸÜÿ™ÿ±ŸÑ ÿØ⁄©ŸÖŸá‚ÄåŸáÿß Ÿæÿß€å€åŸÜ ÿµŸÅÿ≠Ÿá */
    .control-btns {
      display: none;
      flex-direction: row;
      justify-content: center;
      gap: 14px;
      margin-top: 32px;
      z-index: 100;
      position: fixed;
      left: 0; right: 0; bottom: 28px;
      pointer-events: none;
    }
    .control-btn {
      padding: 18px 28px;
      background: linear-gradient(135deg, #0ff, #08f);
      color: #000;
      border: none;
      border-radius: 14px;
      font-size: 1.25em;
      font-weight: bold;
      cursor: pointer;
      min-width: 140px;
      box-shadow: 0 0 12px #0ff8;
      pointer-events: all;
      transition: all .18s;
    }
    .control-btn:active { filter: brightness(0.9); }

    #pauseMsg {
      display:none;
      position: fixed;
      left: 50%; bottom: 94px; transform: translateX(-50%);
      background: rgba(0,8,32,0.91);
      color: #fff;
      font-size: 1.18em;
      padding: 18px 32px 14px 32px;
      border-radius: 11px;
      border: 2px solid #0ff7;
      box-shadow: 0 0 28px #0ff7;
      z-index: 500;
      font-family: inherit;
      text-align:center;
      font-weight: 500;
      max-width: 94vw;
      line-height: 1.6;
      user-select: none;
      pointer-events: none;
    }

    /* Animation */
    @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.7; } 50% { transform: scale(1.06); opacity: 1; } }
    @keyframes loader-spin {
      0%   { filter: brightness(1.1); }
      90%  { filter: brightness(1.25); }
      100% { transform: translate(-50%,-50%) rotate(360deg); filter: brightness(1.1);}
    }

    /* Mobile responsiveness */
    @media (max-width: 600px) {
      .radar { width: 84vw; height: 84vw; min-width: 160px; min-height: 160px; }
      .dolphin-loader { width: 50vw; height: 50vw; min-width: 54px; min-height: 54px; }
      .glass-card { padding: 16px; }
      .control-btns { gap: 10px; bottom: 20px; }
      .control-btn { min-width: 90px; padding: 14px 10vw; font-size: 1em;}
      #pauseMsg { font-size: 1em; padding: 10px 12vw 8px 12vw;}
    }
  </style>
</head>
<body>
  <!-- ŸÖÿßÿ™ÿ±€å⁄©ÿ≥ ÿßŸÅ⁄©ÿ™ -->
  <canvas id="matrixCanvas"></canvas>

  <!-- UI ÿßŸàŸÑ€åŸá ÿßÿ≥⁄©ŸÜ -->
  <div class="container" id="mainUI">
    <div class="glass-card">
      <h1>Welcome, <span id="username">User</span> üëã</h1>
      <p>Click the button below to scan the blockchain for forgotten wallets.<br>
      <span style="font-size:1.07em;color:#fff9;letter-spacing:0.04em;">Dolphin Finder brings you the most advanced crypto discovery technology on earth.</span></p>
      <button class="scan-btn" onclick="startScan()" id="scanBtn">üöÄ Start Scan</button>
    </div>
  </div>

  <!-- ÿ±ÿßÿØÿßÿ± ÿ≥Ÿá‚Äåÿ®ÿπÿØ€å ÿ®ÿß ŸÑŸàÿØÿ± -->
  <div class="radar" id="radar" style="display:none;">
    <div class="dolphin-loader" id="dolphinLoader"></div>
  </div>

  <!-- ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ⁄©ŸÜÿ™ÿ±ŸÑ Ÿæÿß€å€åŸÜ ÿµŸÅÿ≠Ÿá -->
  <div class="control-btns" id="controlBtns">
    <button class="control-btn" onclick="pauseScan()" id="pauseBtn">‚è∏ Pause</button>
    <button class="control-btn" onclick="resumeScan()" id="resumeBtn" style="display: none;">‚ñ∂ Resume</button>
  </div>

  <!-- Ÿæ€åÿßŸÖ ÿ™ŸàŸÇŸÅ ÿ≥ÿ±⁄Ü -->
  <div id="pauseMsg">
    <b>Search Paused</b><br>
    Scanning is temporarily stopped.<br>
    Tap <span style="color:#0ff;font-weight:bold;">Resume</span> to continue searching the blockchain for lost wallets.
  </div>

  <script>
    const API_BASE = "https://dolphinwalletfinderbackend-production.up.railway.app/api";
    const token = localStorage.getItem("token");
    if (!token) window.location.href = "login.html";

    fetch(`${API_BASE}/me`, {
      headers: { Authorization: "Bearer " + token }
    }).then(res => res.json())
      .then(data => {
        document.getElementById("username").textContent = data.username || "User";
      });

    let scanTimeout, paused = false, matrixInterval, scanRunning = false;

    function startScan() {
      scanRunning = true;
      document.getElementById("mainUI").style.display = "none";
      document.getElementById("radar").style.display = "block";
      document.getElementById("controlBtns").style.display = "flex";
      document.getElementById("matrixCanvas").style.display = "block";
      document.getElementById("dolphinLoader").style.animationPlayState = "running";
      document.getElementById("dolphinLoader").style.opacity = 1;
      resumeMatrix();

      // ÿ±ÿßÿØÿßÿ± ÿßŸÅ⁄©ÿ™ €≥ÿ®ÿπÿØ€å ŸÜŸàÿ± ŸÖÿ™ÿ≠ÿ±⁄©
      document.getElementById("radar").style.filter = "brightness(1.1) drop-shadow(0 0 20px #0ff6)";

      const delay = Math.floor(Math.random() * (10000 - 4000 + 1)) + 4000;
      scanTimeout = setTimeout(() => {
        if (!paused) {
          const wallet = simulateScan();
          fetch(`${API_BASE}/wallets`, {
            method: "POST",
            headers: {
              "Authorization": "Bearer " + token,
              "Content-Type": "application/json"
            },
            body: JSON.stringify(wallet)
          })
          .then(() => window.location.href = "results.html");
        }
      }, delay);
    }

    function pauseScan() {
      if (!scanRunning || paused) return;
      paused = true;
      clearTimeout(scanTimeout);
      pauseMatrix();
      document.getElementById("dolphinLoader").style.animationPlayState = "paused";
      document.getElementById("dolphinLoader").style.opacity = 0.5;
      document.getElementById("pauseBtn").style.display = "none";
      document.getElementById("resumeBtn").style.display = "inline-block";
      document.getElementById("pauseMsg").style.display = "block";
      document.getElementById("radar").style.filter = "brightness(.7) grayscale(.7)";
    }

    function resumeScan() {
      if (!scanRunning || !paused) return;
      paused = false;
      document.getElementById("dolphinLoader").style.animationPlayState = "running";
      document.getElementById("dolphinLoader").style.opacity = 1;
      document.getElementById("resumeBtn").style.display = "none";
      document.getElementById("pauseBtn").style.display = "inline-block";
      document.getElementById("pauseMsg").style.display = "none";
      document.getElementById("radar").style.filter = "brightness(1.08)";
      resumeMatrix();

      // ÿ±€å‚Äåÿßÿ≥ÿ™ÿßÿ±ÿ™ ÿ™ÿß€åŸÖÿ± ÿ™ÿß Ÿæ€åÿØÿß ÿ¥ÿØŸÜ ŸàŸÑÿ™ (ŸáŸÖŸàŸÜ ÿ™ÿß€åŸÖ ŸÇÿ®ŸÑ€å ÿ±Ÿà ŸÖÿ¨ÿØÿØ ŸÜŸÖ€å‚Äå⁄Ø€åÿ±Ÿáÿå ÿ±ŸÜÿØŸàŸÖ ÿ¨ÿØ€åÿØ ŸÖ€å‚Äå⁄Ø€åÿ±Ÿá)
      const delay = Math.floor(Math.random() * (10000 - 4000 + 1)) + 4000;
      scanTimeout = setTimeout(() => {
        if (!paused) {
          const wallet = simulateScan();
          fetch(`${API_BASE}/wallets`, {
            method: "POST",
            headers: {
              "Authorization": "Bearer " + token,
              "Content-Type": "application/json"
            },
            body: JSON.stringify(wallet)
          })
          .then(() => window.location.href = "results.html");
        }
      }, delay);
    }

    // Matrix effect
    const canvas = document.getElementById("matrixCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const letters = "crypto wallet private key blockchain token access recovery ethereum bitcoin seed phrase secure decentralized dolphin finder search scanning AI lost asset sweep scan flash cyber spectrum".split(" ");
    const fontSize = 14;
    const columns = Math.floor(canvas.width / fontSize);
    const drops = Array(columns).fill(1);

    function drawMatrix() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "rgba(0, 0, 0, 0.07)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.shadowColor = "#0ff";
      ctx.shadowBlur = 10;
      ctx.fillStyle = "#0ff";
      ctx.font = fontSize + "px monospace";

      for (let i = 0; i < drops.length; i++) {
        const text = letters[Math.floor(Math.random() * letters.length)];
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
        if (drops[i] * fontSize > canvas.height || Math.random() > 0.98) {
          drops[i] = 0;
        }
        drops[i]++;
      }
    }

    function resumeMatrix() {
      if (matrixInterval) clearInterval(matrixInterval);
      matrixInterval = setInterval(drawMatrix, 40);
    }

    function pauseMatrix() {
      clearInterval(matrixInterval);
    }

    window.addEventListener("resize", () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
  <script src="../assets/wallets.js"></script>
</body>
</html>
